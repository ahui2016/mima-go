{{define "index"}}
    {{template "top"}}
    <p>mima-go .. <strong>All</strong> (<a href="/logout">logout</a>)</p>

    <hr/>

    <p style="text-align:right">
        <a href="/search">Alias</a>
        . <a href="/add">Add</a>
        . <a href="/recyclebin">Recycle Bin</a>
    </p>

    <ul>
        {{range .}}
            <li>
                <div>
                    <strong>{{.Title}}</strong>
                    <span class="ButtonsForTitle">
                        {{if .Username}}<a href="#" onclick="copyInBackground({id:'{{.ID}}'}, '/api/copy-username')">名</a>{{end}}
                        {{if .Password}}<a href="#" onclick="copyInBackground({id:'{{.ID}}'}, '/api/copy-password')">密</a>{{end}}
                        <a href="/edit?id={{.ID}}">改</a>
                        <a href="/delete?id={{.ID}}">删</a>
                    </span><br/>
                    {{if .Alias}}[{{.Alias}}]<br/>{{end}}
                    {{if .Username}}{{.Username}}<br/>{{end}}
                    {{if .Notes}}{{.Notes}}{{end}}
                </div>
            </li>
        {{ else }}
            <li>空空如也。</li>
        {{end}}
    </ul>

    <script>
        function copyInBackground(data, url) {
            // https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/Sending_forms_through_JavaScript
            const XHR = new XMLHttpRequest();
            const FD = new FormData();
            for (const name in data) {
                if (data.hasOwnProperty(name)) {
                    FD.append(name, data[name]);
                }
            }
            XHR.onload = function () {
                if (XHR.status !== 200) {
                    console.log(XHR.responseText);
                    window.alert(XHR.responseText);
                }
            };
            XHR.open('POST', url);
            XHR.onerror = function () {
                window.alert('出错！获取数据失败。')
            };
            XHR.send(FD);
        }
    </script>

    {{template "bottom"}}
{{end}}
